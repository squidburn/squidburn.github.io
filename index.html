<!DOCTYPE html>
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <title>贪吃蛇游戏</title>
        <style>
            body {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                background-color: #f0f0f0;
                margin: 0;
            }

            canvas {
                background-color: #fff;
                border: 1px solid #000;
            }
        </style>
    </head>

    <body>
        <canvas id="gameCanvas" width="400" height="400"></canvas>
        <script>
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            const gridSize = 20;
            const tileSize = canvas.width / gridSize;
            let snake = [{ x: 10, y: 10 }];
            let apple = { x: 15, y: 15 };
            let velocity = { x: 0, y: 0 };
            let previousTimeStamp = 0;

            function gameLoop(timeStamp) {
                if (timeStamp - previousTimeStamp > 100) {
                    previousTimeStamp = timeStamp;
                    update();
                    draw();
                }
                requestAnimationFrame(gameLoop);
            }

            function update() {
                const head = {
                    x: (snake[0].x + velocity.x + gridSize) % gridSize,
                    y: (snake[0].y + velocity.y + gridSize) % gridSize
                };
                snake.unshift(head);

                if (head.x === apple.x && head.y === apple.y) {
                    placeApple();
                } else {
                    snake.pop();
                }
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                ctx.fillStyle = 'green';
                snake.forEach(segment => {
                    ctx.fillRect(segment.x * tileSize, segment.y * tileSize, tileSize, tileSize);
                });

                ctx.fillStyle = 'red';
                ctx.fillRect(apple.x * tileSize, apple.y * tileSize, tileSize, tileSize);
            }

            function placeApple() {
                apple = {
                    x: Math.floor(Math.random() * gridSize),
                    y: Math.floor(Math.random() * gridSize)
                };
            }

            document.addEventListener('keydown', (event) => {
                switch (event.key) {
                    case 'ArrowUp':
                        if (velocity.y !== 1) {
                            velocity = { x: 0, y: -1 };
                        }
                        break;
                    case 'ArrowDown':
                        if (velocity.y !== -1) {
                            velocity = { x: 0, y: 1 };
                        }
                        break;
                    case 'ArrowLeft':
                        if (velocity.x !== 1) {
                            velocity = { x: -1, y: 0 };
                        }
                        break;
                    case 'ArrowRight':
                        if (velocity.x !== -1) {
                            velocity = { x: 1, y: 0 };
                        }
                        break;
                }
            });

            requestAnimationFrame(gameLoop);
        </script>
    </body>

</html>